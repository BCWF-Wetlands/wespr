<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Prepare data for Wespr calculations • wespr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare data for Wespr calculations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wespr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/calculate_wesp_scores.html">Calculate Wespr Scores</a></li>
    <li><a class="dropdown-item" href="../articles/prepare-rawdata.html">Prepare data for Wespr calculations</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prepare data for Wespr calculations</h1>
            
      

      <div class="d-none name"><code>prepare-rawdata.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bcwf-wetlands.github.io/wespr/">wespr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="raw-data-imports">Raw data imports<a class="anchor" aria-label="anchor" href="#raw-data-imports"></a>
</h2>
<p>The first step in calculating wespr scores is to standardise and
quality check the input data.</p>
<p>As of March 2025, data collection is comprised of there parts: -
field data - collected using survey123 form - office questions -
collected using a survey123 form - office questions - scripted using the
<a href="https://github.com/BCWF-Wetlands/WESP_OF" class="external-link">WESP_OF</a> github
repo.</p>
<div class="section level3">
<h3 id="field-data">Field data<a class="anchor" aria-label="anchor" href="#field-data"></a>
</h3>
<p>Field data is collected on site using the survey123 form. This is
intended to control data inputs and standardize the data collection
process. These comprise all the <em>field</em> and <em>stressor</em>
based questions.</p>
<p>The data is exported from survey123 as a csv file. Note some minor
manual edits were required to make the data file compatible to read in,
i.e. format datatime column. These should be minimal in future as the
processes is continually improved.</p>
<p>An example data file is included within this package for testing.Note
using system.file() can create some difficulties on a OS operating
system.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">file_123</span> <span class="op">&lt;-</span> <span class="st">'field_survey123_edited_04.14.2025.xls'</span></span>
<span><span class="va">s123_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">'extdata'</span>,<span class="va">file_123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">field</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="va">s123_file</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span></span>
<span><span class="co">#field_excel &lt;- read_xls(field)</span></span>
<span></span>
<span><span class="co">#head(field)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="office-data">Office data<a class="anchor" aria-label="anchor" href="#office-data"></a>
</h3>
<p>Office data is collected in two part (by users either post or pre
fieldwork, and compiled as part of the <a href="https://github.com/BCWF-Wetlands/WESP_OF" class="external-link">BCWF-Wetlands/WESP_OF</a>.
These are merged into a single file and exported as a .xls file. An
example data file is included within this package for testing.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">office</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/scripted_office.xlsx"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#head(office)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="compiling-and-formatting-data">Compiling and formatting data<a class="anchor" aria-label="anchor" href="#compiling-and-formatting-data"></a>
</h2>
<p>The data is compiled and formatted using the
<code>combine_rawdata</code> function. This function takes the field and
office data as inputs, and outputs a single data frame with the data
formatted for use in the wespr calculations.</p>
<p>Users need to define the file path to the field and office data
files, the ecoregion to be reviewed. In this example we define the EcoP
as “GD” for Georgia Depression.</p>
<p>Users can then define if they want to review the formatted subfiles
(i.e. office and field data), and if they want to save the final data
file and if the file should be overwritten</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Preparing the raw data</span></span>
<span></span>
<span><span class="va">ww</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_rawdata.html">combine_rawdata</a></span><span class="op">(</span></span>
<span>    <span class="va">field_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/field_survey123_edited_04.14.2025.xls"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span>,</span>
<span>    <span class="va">office_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/scripted_office.xlsx"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span>,</span>
<span>    EcoP <span class="op">=</span> <span class="st">"GD"</span>,</span>
<span>    write_subfiles <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    out_dir <span class="op">=</span> <span class="st">"input_data"</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">ww</span>, <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="st">"input_data/wetFlat_20250417.csv"</span><span class="op">)</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>If we choose to review the subfiles, these will be written to the
out_dir directory.</p>
</div>
<div class="section level2">
<h2 id="quality-checking-the-data">Quality checking the data<a class="anchor" aria-label="anchor" href="#quality-checking-the-data"></a>
</h2>
<p>We can then check QA the data using the <code>check_indata</code>
function. This function checks the data for missing values, and ensures
the data is in the correct format.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_data/wetFlat_20250417.csv"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/check_indata.html">check_indata</a></span><span class="op">(</span><span class="va">indata</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-final-output">The final output<a class="anchor" aria-label="anchor" href="#the-final-output"></a>
</h2>
<p>An example of the final compiled data is shown, with the first 10
questions (rows) and 6 sites (columns) shown:</p>
<pre><code>Question,1,2,3,4,5,6
F1_1,1,0,1,1,1,2
F1_2,0,3,3,2,0,2
F1_3,1,0,3,1,1,1
F1_4,1,4,1,1,1,3
F1_5,1,0,1,1,1,0
F1_6,1,1,1,1,1,4
F2_A1,0,0,0,0,0,1
F2_A2,0,0,0,0,0,0
F2_B1,0,1,0,0,0,0
F2_B2,1,0,1,1,1,0</code></pre>
<p>The prepared dataset is then ready for use in wespr calculations. See
<a href="https://bcwf-wetlands.github.io/wespr/articles/calculate_wesp_scores.html">here</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Genevieve Perkins, Andy Teucher, Don Morgan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
