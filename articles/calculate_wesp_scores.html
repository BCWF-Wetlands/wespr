<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculate Wespr Scores • wespr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Wespr Scores">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wespr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/calculate_wesp_scores.html">Calculate Wespr Scores</a></li>
    <li><a class="dropdown-item" href="../articles/prepare-rawdata.html">Prepare data for Wespr calculations</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Wespr Scores</h1>
            
      

      <div class="d-none name"><code>calculate_wesp_scores.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bcwf-wetlands.github.io/wespr/">wespr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="calculate-wespr-scores">Calculate Wespr Scores<a class="anchor" aria-label="anchor" href="#calculate-wespr-scores"></a>
</h2>
<p>Once the wespr package has been installed, and the raw data processed
using the steps outlined in the previous <a href="https://bcwf-wetlands.github.io/wespr/articles/prepare-rawdata.html">vignette</a>,
we can calculate the wespr scores and compare the scores to the
ecoprovince calibration data.</p>
<p>We have included an example file in the package, which we can use for
demonstration purposes:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wesp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_data/reference_GD_20250620.csv"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span></span>
<span><span class="va">wesp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_wesp_data.html">load_wesp_data</a></span><span class="op">(</span><span class="va">wesp_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">wesp_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate a key for site names </span></span>
<span><span class="va">wespkey</span> <span class="op">&lt;-</span> <span class="va">wesp_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">q_no</span> <span class="op">==</span> <span class="st">"Wetland"</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">response_no</span><span class="op">)</span>,</span>
<span>                  names_to <span class="op">=</span> <span class="st">"site_no"</span>,</span>
<span>                  values_to <span class="op">=</span> <span class="st">"wetland_id"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">response_no</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">site_no</span> <span class="op">!=</span> <span class="st">"q_no"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"site"</span> <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">site_no</span><span class="op">)</span> </span></code></pre></div>
<p>Next we convert the data into a special <code>wesp_site</code>
object. This process validates the input data, and will give informative
errors if a question is not answered correctly. It also calculates many
“derived values” from the questions, which are common inputs into
different indicator calculations.</p>
<p>If there is more than one site in the input data, you can select
which site you would like to use — if no site is selected it will
default to choosing the first site in the file.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.wesp_site.html">as.wesp_site</a></span><span class="op">(</span><span class="va">wesp_data</span>, site <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>You should not normally need to work with the internals of the
<code>wesp_site</code> object as it is quite complex, however we can get
an overview of what is in it by just typing the name of the object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site</span></span></code></pre></div>
<p>We can see that the responses are loaded, with a few flagged as
incomplete, and the derived values have been calculated. However, the
indicators have not yet been calculated.</p>
<p>Now, we can calculate the indicator scores with the
<code><a href="../reference/calc_indicators.html">calc_indicators()</a></code> function.</p>
<p>You must assign the output of this function back to the original
<code>wesp_site</code> object, as it updates the <code>indicators</code>
with the calculated values:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_indicators.html">calc_indicators</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span></code></pre></div>
<p>If we view the site object again, we can see the calculated indicator
scores.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site</span></span></code></pre></div>
<p>We probably want to get the indicator scores out as a usable object.
We can do that with <code><a href="../reference/get_indicator_scores.html">get_indicator_scores()</a></code>, which gives
them to us as a <code>data.frame</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_indicator_scores.html">get_indicator_scores</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add site specific names</span></span>
<span><span class="va">ind_scores</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">wespkey</span>, <span class="va">ind_scores</span>, by <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ind_scores</span></span></code></pre></div>
<p>Similarly, we can extract the original responses with
<code><a href="../reference/get_responses.html">get_responses()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_responses.html">get_responses</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span></code></pre></div>
<p>We can also get out a data.frame of derived values, those values
which are calculated from the responses, and used as inputs into many
indicators.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_derived_values.html">get_derived_values</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="calculating-multiple-site-scores">Calculating multiple site scores<a class="anchor" aria-label="anchor" href="#calculating-multiple-site-scores"></a>
</h3>
<p>We may wish to calculate indicator scores for multiple sites. If we
only need the raw values for each site we can use the
<code><a href="../reference/calculate_multi_site.html">calculate_multi_site()</a></code> function. Which requires the data to
firstly be loaded using the <code><a href="../reference/load_wesp_data.html">load_wesp_data()</a></code> function. For
example the work flow would be:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wesp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_data/reference_GD_20250620.csv"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span></span>
<span><span class="va">wesp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_wesp_data.html">load_wesp_data</a></span><span class="op">(</span><span class="va">wesp_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate a site key </span></span>
<span><span class="co"># generate a key for site names </span></span>
<span><span class="va">wespkey</span> <span class="op">&lt;-</span> <span class="va">wesp_data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">q_no</span> <span class="op">==</span> <span class="st">"Wetland"</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">response_no</span><span class="op">)</span>,</span>
<span>                  names_to <span class="op">=</span> <span class="st">"site_no"</span>,</span>
<span>                  values_to <span class="op">=</span> <span class="st">"wetland_id"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">response_no</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">site_no</span> <span class="op">!=</span> <span class="st">"q_no"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"site_"</span>, <span class="st">""</span>, <span class="va">site_no</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">site_no</span><span class="op">)</span></span>
<span></span>
<span><span class="va">allsites</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_multi_site.html">calculate_multi_site</a></span><span class="op">(</span><span class="va">wesp_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add site specific names</span></span>
<span><span class="va">allsites</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">wespkey</span>, <span class="va">allsites</span>, by <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span></code></pre></div>
<p>This will return a date.frame with all the values combined for each
site within the dataset provided.</p>
</div>
<div class="section level3">
<h3 id="assign-jenks-scores">Assign Jenks scores<a class="anchor" aria-label="anchor" href="#assign-jenks-scores"></a>
</h3>
<p>Once we have calculated our scores we may wish to compare to see how
our particular site compares with other wetlands in the same
Ecoprovince. <a href="https://bcwfwatershedteam.ca/wetland-ecosystem-services-protocol/" class="external-link">Wespr
protocol</a> is based on wetland assessment in eight Ecoprovinces
(Georgia Depression (GD), Southern Interior (SI), Central Interior (CI),
Southern Interior Mountains (SIM), Sub-Boreal Interior (SBI), Boreal and
Taiga Plains (BTP), Northern Boreal Mountains (NBM), and Coast and
Mountains (CM)).</p>
<p>In order to compare a particular site with the calibration sites
(typically 100 sites per ecoregion), we can use the
<code><a href="../reference/assign_jenks_score.html">assign_jenks_score()</a></code> function. This function requires the
data to be loaded using the <code><a href="../reference/load_wesp_data.html">load_wesp_data()</a></code> function as
above.</p>
<p>We can use the example below in which we have one site as an
example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select file</span></span>
<span><span class="va">wesp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_data/reference_singlesite.csv"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#load file and convert to wesp</span></span>
<span><span class="va">wesp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_wesp_data.html">load_wesp_data</a></span><span class="op">(</span><span class="va">wesp</span><span class="op">)</span></span>
<span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.wesp_site.html">as.wesp_site</a></span><span class="op">(</span><span class="va">wesp_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># update site name</span></span>
<span><span class="va">site</span><span class="op">$</span><span class="va">site_name</span> <span class="op">&lt;-</span> <span class="va">wesp_data</span><span class="op">$</span><span class="va">site_1</span><span class="op">[</span><span class="va">wesp_data</span><span class="op">$</span><span class="va">q_no</span> <span class="op">==</span> <span class="st">"Wetland"</span><span class="op">]</span></span></code></pre></div>
<p>We then calculate the indicator scores and extract the values into a
table. Note this process is based on a single site, but can be iterated
for multiple sites.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate the scores and extract the indicator values </span></span>
<span><span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_indicators.html">calc_indicators</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span>
<span><span class="va">ind_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_indicator_scores.html">get_indicator_scores</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span></code></pre></div>
<p>An example format of the ind_score output is shown, with the service
type (rows) for each site with a column for function (fun) and benefit
(ben). Note not every service has both a function and benefit so you
will see NA values.</p>
<pre><code>  site   indicator    fun   ben
   &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 site_1 WS         3.61   6.98
 2 site_1 SR         0.778  4.28
 3 site_1 PR         6.20   3.06
 4 site_1 CP         6.78  NA   
 5 site_1 FR         1.67   7.51
 6 site_1 SENS       4.86  NA   
 7 site_1 STR        9.58  NA   
 8 site_1 NR         5.52   3.06
 9 site_1 APP        0      2.99
10 site_1 PD         0      5.51
11 site_1 KMH        2.99   5.60
12 site_1 WB         0     10   
13 site_1 POL        6.30   1.67
14 site_1 RSB        6.94   4.83
15 site_1 OE         4.54  NA   
16 site_1 AM         5.03   3.10
17 site_1 FH         0      3.33
18 site_1 SFTS       2.94   3.27
19 site_1 CRI       NA      6.58
</code></pre>
<p>We can then use the <code><a href="../reference/assign_jenks_score.html">assign_jenks_score()</a></code> function to
assign the Jenks breaks to each of the values. This function requires
the calibration data to be loaded, which is included in the package.
Calibration data is collected from approximate 100 sites in each
ecoprovince. This data is then normalised and used to establish the
threshold values for each service and function/benefit based on a
distribution of values for the 100 sites. These thresholds can then be
used as benchmarks for a given wetland within the same ecoprovince, to
establish a service as high/medium/low. Note as thresholds are based on
normalised values, we can extrapolate these to raw scores and assign the
closest score based on the calibration dataset. Note in some cases where
a raw score for the site to be assessed is below or above the raw
calibration data score, these will be asssigned a L or H rank
respectively. A warning message will also notify users if this is the
case and for which service.</p>
<p>To assign a jenks score, we require 1) the indicator score data (as
shown in steps above), 2) calibration scores (which are included in the
package), and 3) the Ecoprovince to be assessed.</p>
<p>If the ecoprovince does not yet have calibration data loaded, users
should select the next best ecoprovince available.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_jenks_score.html">assign_jenks_score</a></span><span class="op">(</span><span class="va">ind_scores</span>, <span class="va">calibration_scores</span>, EcoP <span class="op">=</span> <span class="st">"GD"</span>, report <span class="op">=</span> <span class="cn">FALSE</span>, output_dir <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p>The output scores will include a column with a calibration_score
(L,M,H,NA)</p>
<pre><code>site   indicator value service_type calibrated_score
   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;           
 1 site_1 WS        3.61  f            L               
 2 site_1 SR        0.778 f            M               
 3 site_1 PR        6.20  f            M               
 4 site_1 CP        6.78  f            L               
 5 site_1 FR        1.67  f            L               
 6 site_1 SENS      4.86  f            L               
 7 site_1 STR       9.58  f            H               
 8 site_1 NR        5.52  f            M               
 9 site_1 APP       0     f            L               
10 site_1 PD        0     f            L  
</code></pre>
<p>This is an on-going project and data will be added as comes
available. Steps to update the calibration data are outline <a href="https://github.com/BCWF-Wetlands/wespr/tree/main/data-raw" class="external-link">here</a>
Note this is an advanced/admin level action, please contact the package
dev team for assistance.</p>
</div>
<div class="section level3">
<h3 id="calculating-jenks-scores-new-ecoprovinces">Calculating Jenks Scores (new Ecoprovinces)<a class="anchor" aria-label="anchor" href="#calculating-jenks-scores-new-ecoprovinces"></a>
</h3>
<p>Another method to step through the entire process of calculating site
scores, and assigning them to a high medium and low category is to use
the <code><a href="../reference/calculate_jenks_score.html">calculate_jenks_score()</a></code> function. This function
requires the data to be loaded using the <code><a href="../reference/load_wesp_data.html">load_wesp_data()</a></code>
function as above.</p>
<p>This will calculate the indicator scores for each site, normalize the
data across all sites for the given ecosystem function or benefit then
calculate the Jenks breaks for each value to assign high, medium and low
categories. The process will also flag unusual results, such as all
values being the same across all sites.</p>
<p>Note the <code><a href="../reference/calculate_jenks_score.html">calculate_jenks_score()</a></code> function includes the
steps described above to calculate all site scores. An example workflow
using this function would be:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wesp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_data/reference_singlesite.csv"</span>, package <span class="op">=</span> <span class="st">"wespr"</span><span class="op">)</span></span>
<span><span class="va">wesp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_wesp_data.html">load_wesp_data</a></span><span class="op">(</span><span class="va">wesp_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/calculate_jenks_score.html">calculate_jenks_score</a></span><span class="op">(</span><span class="va">wesp_data</span>, out_dir <span class="op">=</span> <span class="st">"temp"</span>,  out_name <span class="op">=</span> <span class="st">"wesp_scores.csv"</span><span class="op">)</span></span></code></pre></div>
<p>With the exception of generating calibration data for a new
ecoprovince, we strongly suggest to use the internal calibration data
per ecoprovince to provide a realistic comparison. This function is
included for exploration purposes only.</p>
</div>
<div class="section level3">
<h3 id="anatomy-of-the-wesp_site-object">Anatomy of the <code>wesp_site</code> object<a class="anchor" aria-label="anchor" href="#anatomy-of-the-wesp_site-object"></a>
</h3>
<p>As mentioned above, this is a large, complex object, and it is almost
always best to interact with the <code>wesp_site</code> object via the
provided functions. If there is functionality that is missing please <a href="https://github.com/BCWF-Wetlands/wespr/issues" class="external-link">open an
issue</a>.</p>
<p>It has four elements:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span></span></code></pre></div>
<p>The first three (<code>site_name</code>, <code>questions</code>, and
<code>derived_values</code>) are populated when the
<code>wesp_site</code> object is created, but the
<code>indicators</code> element is just a placeholder, until
<code><a href="../reference/calc_indicators.html">calc_indicators()</a></code> has been run:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site</span><span class="op">$</span><span class="va">site_name</span></span>
<span></span>
<span><span class="co"># The questions element is large and complex, so we will just show the names:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">site</span><span class="op">$</span><span class="va">questions</span><span class="op">)</span></span>
<span></span>
<span><span class="va">site</span><span class="op">$</span><span class="va">derived_values</span></span>
<span></span>
<span><span class="va">site</span><span class="op">$</span><span class="va">indicators</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="development">Development<a class="anchor" aria-label="anchor" href="#development"></a>
</h3>
<div class="section level4">
<h4 id="updating-internal-data">Updating internal data<a class="anchor" aria-label="anchor" href="#updating-internal-data"></a>
</h4>
<p>The wespr package contains two internal datasets which facilitate
question validation and indicator calculations:
<code>question_metadata</code> and
<code>indicator_weightings</code>.</p>
<p>These are updated by:</p>
<ol style="list-style-type: decimal">
<li><p>Update the Google Sheet at: <a href="https://docs.google.com/spreadsheets/d/1l2h7Z65H5z0cKv_gvorxkT6k9LC7ZKLS/edit#gid=924841838" class="external-link uri">https://docs.google.com/spreadsheets/d/1l2h7Z65H5z0cKv_gvorxkT6k9LC7ZKLS/edit#gid=924841838</a>
(you need to be authorized to edit this document)</p></li>
<li><p>Run the script in <code>data-raw/internal-data.R</code></p></li>
<li><p>Reload/reinstall the package.</p></li>
<li><p>Run <code>devtools::check()</code> to make sure the changes you
made to the Google Sheet haven’t broken any existing behaviour.</p></li>
<li><p>Commit the changes to <code>R/sysdata.rda</code> (this file
contains both datasets)</p></li>
</ol>
</div>
<div class="section level4">
<h4 id="updating-calibration-data">Updating Calibration data<a class="anchor" aria-label="anchor" href="#updating-calibration-data"></a>
</h4>
<p>The wespr package contains the summarized
<code>calibration_scores</code>. These will require updating as more
calibration data becomes available.</p>
<p>These are updated by:</p>
<ol style="list-style-type: decimal">
<li><p>Run the script in
<code>data-raw/upload-calibration-data.R</code></p></li>
<li><p>Reload/reinstall the package.</p></li>
<li><p>Run <code>devtools::check()</code> to make sure the changes you
made to the Google Sheet haven’t broken any existing behaviour.</p></li>
<li><p>The calibration data is accessible to users via the
<code>calibration_scores</code> function.</p></li>
</ol>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Genevieve Perkins, Andy Teucher, Don Morgan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
